{% load staticfiles %}
<html>
        <head>
                <meta charset='utf-8'>
                <title>Weather</title>
                <link rel="stylesheet" href="{% static 'css/weather/style.css' %}">
                <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
                <link rel="shortcut icon" type="image/png" href="{% static 'favicon.ico' %}">
                <script src="http://code.jquery.com/jquery-1.10.2.min.js" type="text/javascript"></script>
                <script src="https://api-maps.yandex.ru/2.0/?load=package.full&lang=eu-EU" type="text/javascript"></script>


                <script type="text/javascript">
                        function getCookie(name) {
                                var cookieValue = null;
                                if (document.cookie && document.cookie !== '') {
                                        var cookies = document.cookie.split(';');
                                        for (var i = 0; i < cookies.length; i++) {
                                                var cookie = jQuery.trim(cookies[i]);
                                                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                        break;
                                                }
                                        }
                                }
                                return cookieValue;
                        }
                        $(document).ready(function(){
                                ymaps.ready(function(){
                                        var geolocation = ymaps.geolocation;
                                        $.ajax({
                                                url: '/weather/',
                                                type: "POST",
                                                data: {'city': geolocation.city, csrfmiddlewaretoken: getCookie('csrftoken')},
                                                success: function(data) {
                                                        var conditions = data.conditions;
                                                        $('#temperature').html(data.temperature + '&#176');
                                                        $('#conditions').html(data.conditions);
                                                        var img = document.getElementById('svg');
                                                        if (conditions == 'Ясно') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/zcyj.jpg)';
                                                                img.src = '/static/sun.svg';
                                                        }
                                                        if (conditions == 'Пасмурно') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/gfcvehyj.jpg)';
                                                                img.src = '/static/cloudy.svg';
                                                        }
                                                        if (conditions == 'Малооблачно') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/vfkjj,kfxyj.jpg)';
                                                                img.src = '/static/css/weather/mcloudy.svg';
                                                        }
                                                        if (conditions == 'Облачно с прояснениями') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/j,kfxyjcghjzcytybzvb.jpg)';
                                                                img.src = '/static/css/weather/cloudysun.svg';
                                                        }
                                                        if (conditions == 'Небольшой снег') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/cytu.jpg)';
                                                                img.src = '/static/css/weather/snow.svg';
                                                        }
                                                        if (conditions == 'Небольшой дождь') {
                                                                document.getElementById('background').style.backgroundImage = 'url(/static/css/weather/lj;lm.jpg)';
                                                                img.src = '/static/css/weather/rain.svg';
                                                        }
                                                },
                                        });    
                                });
                        });
                        
                </script>  
        </head>
        <body>
                <div id='background'>
                        <div class='container-fluid'>
                                <span id = 'temperature'></span><br>
                                <img id = 'svg'>
                                <span id = 'conditions'></><br>
                        </div>
                </div>
        </body>
</html>
